clear all
clc
close all
start=clock;
sample_class=1:40;%????????
sample_classnum=size(sample_class,2);%??????????
fprintf('????????????....................\n\n');

for train_samplesize=3:8;
    train=1:train_samplesize;%????????????
    test=train_samplesize+1:10;%????????????
    
    train_num=size(train,2);%??????????????
    test_num=size(test,2);%??????????????
    
    address=[pwd '/ORL/'];
    %????????????
    allsamples=readsample(address,sample_class,train);
    
    %??????PCA????????
    [newsample base]=pca(allsamples,0.9);
    %????Sw,Sb
    [sw sb]=computswb(newsample,sample_classnum,train_num);
    
    %????????????
    testsample=readsample(address,sample_class,test);
    best_acc=0;%??????????
    %????????????????
    for temp_dimension=1:1:length(sw)
        vsort1=projectto(sw,sb,temp_dimension);
        
        %??????????????????????????
        tstsample=testsample*base*vsort1;
        trainsample=newsample*vsort1;
        %??????????
        accuracy=computaccu(tstsample,test_num,trainsample,train_num);
        if accuracy>best_acc
            best_dimension=temp_dimension;%????????????????
            best_acc=accuracy;
        end
    end
    %---------------------------------????????----------------------------------
    fprintf('??????????????????%d\n',train_samplesize);
    fprintf('????????????????%d\n',best_dimension);
    fprintf('FisherFace????????????%.2f%%\n',best_acc*100);
    fprintf('????????????????%3.2fs\n\n',etime(clock,start));
end
fprintf('????????????....................\n\n');